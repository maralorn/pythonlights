<!doctype html>
<html lang="de">
	<head>
		<title>Trollhöhlen Lichtcontroller</title>
		<script type="text/javascript" src="static/jscolor/jscolor.js"></script>
		<link href="/css/bootstrap.min.css" rel="stylesheet">
        <style type="text/css">
            .popover { width: 350px; }
        </style>
	</head>
	<body>
		<header id="top" class="navbar navbar-static-top" role="banner" style="margin-bottom: 0px;">
			<div class="container-fluid">
				<nav class="collapse navbar-collapse">
					<ul class="nav navbar-nav">
					{% for preset in presets %}
						<li><a href="loadpreset/{{preset}}">{{preset}}</a></li>
					{% endfor %}
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li><a href="help">Help</a></li>
						<li><a href="restart">Restart Daemon</a></li>
					</ul>
				</nav>
			</div>
		</header>

		<div id="head" style="color: #ffffff; background: #6C5296; padding-bottom: 40px;">
			<div class="container">
				<h1><a style="color: #ffffff;" href="/light/">python<strong>lights</strong></a></h1>
				<p>Die Premium<sup>&#0153;</sup>-Lichtsteuerung in der Trollhöhle</p>
			</div>
		</div>

		<div class="container">
			{% if plugin_error %}
            <!-- Plugin Error! -->
			<div class="row">
				<div class="col-md-12">
					<div class="alert alert-danger">
						<strong>Plugin-Fehler</strong>
						Es gab ein Problem beim Laden eines Plugins.<br />
						<ul>
							<li><a href="error/">Mehr Informationen</a</li>
							<li><a href="restart/">Neu starten</a></li>
						</ul>
					</div>
				</div>
			</div>
            <!-- Plugin Error ENDE -->
			{% endif %}
			<div class="row">
				<div class="col-md-9">
                    <br />
					<!-- Plugin Settings -->
                    <div class="panel-group" id="plugins">
					{% for plugin in active_plugins %}
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <a href="delete/{{ plugin.id }}"><span style="color: darkred;" class="glyphicon glyphicon-remove"></span></a>
                                <a data-toggle="collapse" data-parent="#plugins" href="#plugin{{ plugin.id }}"><strong>{{ plugin.name }}</strong></a>
                                {% if plugin.decay %}
                                <small>verfällt in {{ (plugin.decay - now)|int }}s</small>
                                {% endif %}
                                <div class="pull-right">
                                    <a href="setpriority/{{ plugin.id }}/{{ plugin.priority -1 }}"><span class="glyphicon glyphicon-minus"></span></a>
                                    <strong>{{ plugin.priority }}</strong>
                                    <a href="setpriority/{{ plugin.id }}/{{ plugin.priority +1 }}"><span class="glyphicon glyphicon-plus"></span></a>
                                </div>
                            </div>
                            <div id="plugin{{ plugin.id }}" class="panel-collapse collapse out">
                                <div class="panel-body">
                                    <!-- Mapping -->
                                    <table class="table table-bordered" style="width: 750px;">
                                        <tr>
                                            <td><span class="glyphicon glyphicon-adjust"></span></td>
                                            {% for i in range(5) %}
                                            <!-- LED-Blöcke -->
                                            <td style="width:20%; text-align: justify;">
                                                <table style="width: 100%">
                                                    <tr>
                                                    {% for j in range(5) %}
                                                    <!-- Block {{ j + 1 }} -->
                                                        {% if i*5+j in plugin.mapping %}
                                                        <td style="width: 20%; text-align: center;">{{ i*5+j }}</td>
                                                        {% else %}
                                                        <td style="width: 20%; text-align: center; background: #000000; color: #FFFFFF;">{{ i*5+j }}</td>
                                                        {% endif %}
                                                    {% endfor %}
                                                    </tr>
                                                </table>
                                            </td>
                                            {% endfor %}
                                        </tr>
                                    </table>
                                    <!-- Mapping ENDE -->
                                    <!-- Optionen -->
                                    {% if plugin.get_options()|length > 0 %}
                                    <div class="well">
                                        <form class="form-horizontal" action="setoption/{{ plugin.id }}/" method="POST" role="form">
                                        {% for option in plugin.get_options() %}
                                            <div class="form-group">
                                                <label for="{{ option }}" class="col-sm-4 control-label">{{ plugin.options[option]['display_name'] }}:</label>
                                                <div class="col-sm-2">
                                                    <input type="number" class="form-control" name="{{ option }}" class="{{ option }}" size="10" value="{{ plugin.get_option(option) }}"
                                                            data-toggle="popover" data-original-title="{{ option }}" data-content="{{plugin.options[option]['comment']}}">
                                                </div>
                                            {% if plugin.options[option]['comment']|length > 0 %}
                                            <!--{{plugin.options[option]['comment']}}-->
                                            {% endif %}
                                            </div>
                                        {% endfor %}
                                            <div class="form-group">
                                                <div class="col-sm-offset-2 col-sm-4">
                                                <button type="submit" class="btn btn-success">Update</button>
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    {% endif %}
                                    <!-- Optionen ENDE -->
                                </div>
                            </div>
                        </div>
					{% endfor %}
                    </div>
				</div>
      			<div class="col-md-3">
					<!-- Loadable Plugins -->
					<div class="list-group">
					{% for plugin in plugins %}
						<a class="list-group-item" href="create/{{ plugin }}">{{ plugin }}</a>
					{% endfor %}
					</div>
				</div>
			</div>
		</div>
        <script type="text/javascript" src="/js/jquery-2.1.0.min.js"></script>
        <script type="text/javascript" src="/js/bootstrap.min.js"></script>
        <script>
            $('[data-toggle="popover"]').popover({trigger: 'hover','placement': 'right'});
        </script>
	</body>
</html>
